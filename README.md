# SphereAgent - Android Remote Control Agent

Enterprise-grade Android agent –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏

![Android](https://img.shields.io/badge/Android-26+-green)
![Kotlin](https://img.shields.io/badge/Kotlin-2.0-purple)
![Compose](https://img.shields.io/badge/Jetpack_Compose-2024.04-blue)
![Version](https://img.shields.io/badge/Version-1.0.6-orange)

## üÜï –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v1.0.6 (Enhanced Discovery)

- **üåê Dual Tunnel Support** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–æ–∏—Ö —Ç—É–Ω–Ω–µ–ª–µ–π (`sphere-api` –∏ `sphere-web`) –≤ fallback —Å–ø–∏—Å–∫–µ
- **üõ°Ô∏è Discovery Logic** - –£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤—ã–±–æ—Ä–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—É–±–ª–∏—á–Ω—ã—Ö —Ç—É–Ω–Ω–µ–ª–µ–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏)
- **üêõ Bug Fixes** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö Docker IP –∞–¥—Ä–µ—Å–æ–≤ (172.16.x.x) –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—ã—Ö

## üÜï –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v1.0.5 (Global Access)

- **üåç Global Tunnel Access** - –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∏–∑ –ª—é–±–æ–π —Ç–æ—á–∫–∏ –º–∏—Ä–∞ —á–µ—Ä–µ–∑ `sphere-api.ru.tuna.am`
- **üîÑ Smart Fallback** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –ª–æ–∫–∞–ª—å–Ω—ã–º IP –∏ –ø—É–±–ª–∏—á–Ω—ã–º —Ç—É–Ω–Ω–µ–ª–µ–º
- **üõ°Ô∏è Connection Reliability** - –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ —Å–º–µ–Ω–µ —Å–µ—Ç–∏
- **üîç Zero-Config** - –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

## üÜï –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v1.0.4 (Zero-Config)

- **üîç Zero-Config Auto-Discovery** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ (mDNS/NSD)
- **üåê Network Scanning** - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Å–µ—Ç–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ SphereADB —Å–µ—Ä–≤–µ—Ä–∞
- **üîÑ Smart Fallback** - Remote Config ‚Üí mDNS ‚Üí Network Scan ‚Üí Hardcoded URLs
- **üöá Tuna Tunnel Support** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–µ —Ç—É–Ω–Ω–µ–ª–∏ (sphere-web.ru.tuna.am)
- **üõ† Dependency Injection** - –ù–æ–≤—ã–π NetworkModule –¥–ª—è —á–∏—Å—Ç–æ–≥–æ –∫–æ–¥–∞

## üì± –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **üì∫ Real-time Screen Streaming** - –¢—Ä–∞–Ω—Å–ª—è—Ü–∏—è —ç–∫—Ä–∞–Ω–∞ —á–µ—Ä–µ–∑ WebSocket (JPEG binary frames)
- **üéÆ Remote Control** - Tap, Swipe, Key events, Shell commands
- **üîÑ Auto-Reconnect** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å exponential backoff
- **üåê Fallback Servers** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏
- **‚öôÔ∏è Remote Config** - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–∞
- **üîí Secure Connection** - WSS/HTTPS —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è |
|-----------|------------|
| Language | Kotlin 2.0.21 |
| UI | Jetpack Compose (Material 3) |
| DI | Hilt 2.52 |
| Network | OkHttp 4.12 + WebSocket |
| Persistence | DataStore 1.1.1 |
| Serialization | Kotlinx Serialization |
| Screen Capture | MediaProjection API |
| Input | Accessibility Service / Shell |

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/src/main/java/com/sphere/agent/
‚îú‚îÄ‚îÄ SphereAgentApp.kt          # Application class
‚îú‚îÄ‚îÄ MainActivity.kt            # Main Activity
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îî‚îÄ‚îÄ AgentConfig.kt         # Remote config management
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ SettingsRepository.kt  # DataStore repository
‚îú‚îÄ‚îÄ di/
‚îÇ   ‚îî‚îÄ‚îÄ AppModule.kt           # Hilt modules
‚îú‚îÄ‚îÄ network/
‚îÇ   ‚îî‚îÄ‚îÄ ConnectionManager.kt   # WebSocket connection
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îú‚îÄ‚îÄ ScreenCaptureService.kt    # Foreground service
‚îÇ   ‚îú‚îÄ‚îÄ CommandExecutor.kt         # Shell commands
‚îÇ   ‚îî‚îÄ‚îÄ SphereAccessibilityService.kt  # Non-root input
‚îî‚îÄ‚îÄ ui/
    ‚îú‚îÄ‚îÄ screens/
    ‚îÇ   ‚îî‚îÄ‚îÄ MainScreen.kt      # Main UI
    ‚îú‚îÄ‚îÄ theme/
    ‚îÇ   ‚îú‚îÄ‚îÄ Theme.kt           # Material 3 theme
    ‚îÇ   ‚îî‚îÄ‚îÄ Typography.kt      # Typography
    ‚îî‚îÄ‚îÄ viewmodel/
        ‚îî‚îÄ‚îÄ MainViewModel.kt   # State management
```

## üöÄ –°–±–æ—Ä–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Android Studio Ladybug (2024.2+)
- JDK 17+
- Android SDK 35

### –ö–æ–º–∞–Ω–¥—ã

```bash
# Build debug APK
./gradlew assembleDebug

# Build release APK
./gradlew assembleRelease

# APK location
app/build/outputs/apk/release/sphere-agent-release.apk
```

## üì° WebSocket Protocol

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```
wss://server.com/api/v1/agent/ws/{device_token}
```

### –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –∞–≥–µ–Ω—Ç–∞

```json
{
  "type": "hello",
  "device_id": "uuid",
  "device_name": "Samsung Galaxy S24",
  "device_model": "SM-S921B",
  "android_version": "14",
  "agent_version": "1.0.0",
  "capabilities": ["screen_capture", "touch", "swipe", "key_event", "shell"]
}
```

### –ö–æ–º–∞–Ω–¥—ã –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞

```json
{ "type": "tap", "command_id": "cmd-1", "x": 500, "y": 800 }
{ "type": "swipe", "command_id": "cmd-2", "x": 500, "y": 1200, "x2": 500, "y2": 400, "duration": 300 }
{ "type": "key", "command_id": "cmd-3", "keyCode": 4 }
{ "type": "shell", "command_id": "cmd-4", "command": "pm list packages" }
{ "type": "home" }
{ "type": "back" }
```

### Binary Frames

–≠–∫—Ä–∞–Ω –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–∞–∫ binary WebSocket frames (JPEG data) - –±–µ–∑ base64!

## üîê Permissions

```xml
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
<uses-permission android:name="android.permission.FOREGROUND_SERVICE_MEDIA_PROJECTION" />
<uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" />
```

## üìä Performance

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| FPS | 15-30 |
| Latency | 50-150ms |
| Bandwidth | 0.5-2 Mbps |
| CPU Usage | 5-15% |
| Memory | ~50 MB |

## üìã –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----------|----------|
| `tap` | `x`, `y` | –¢–∞–ø –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º |
| `swipe` | `x1`, `y1`, `x2`, `y2`, `duration` | –°–≤–∞–π–ø |
| `long_press` | `x`, `y`, `duration` | –î–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ |
| `key` | `keycode` | –ù–∞–∂–∞—Ç–∏–µ –∫–ª–∞–≤–∏—à–∏ |
| `text` | `text` | –í–≤–æ–¥ —Ç–µ–∫—Å—Ç–∞ |
| `shell` | `command` | Shell –∫–æ–º–∞–Ω–¥–∞ |
| `home` | - | –ö–Ω–æ–ø–∫–∞ Home |
| `back` | - | –ö–Ω–æ–ø–∫–∞ Back |
| `recent` | - | Recent Apps |

---

**SphereAgent** - —á–∞—Å—Ç—å —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã **SphereADB** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Android —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏.
